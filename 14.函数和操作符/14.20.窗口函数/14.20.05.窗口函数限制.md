### 14.20.5 窗口函数限制

SQL标准规定，窗口函数**不能**在 `UPDATE` 或 `DELETE` 语句中用于更新行。

但可以在这些语句的子查询中使用窗口函数（用于选择行）。

MySQL不支持以下窗口函数特性：

- 聚合窗口函数的 `DISTINCT` 语法。
- 嵌套窗口函数。
- 依赖当前行值的动态帧端点。

解析器能够识别以下窗口结构，但实际上不支持，会产生错误：

- `GROUPS` 帧单位说明符可以解析，但会报错。只支持 `ROWS` 和 `RANGE`。
- 帧规范中的 `EXCLUDE` 子句可以解析，但会报错。
- `IGNORE NULLS` 可以解析，但会报错。只支持 `RESPECT NULLS`。
- `FROM LAST` 可以解析，但会报错。只支持 `FROM FIRST`。

> **注意**
>
> 从MySQL 8.0.28开始，每个 `SELECT` 语句最多支持127个窗口。  
>
> 需要注意的是，单个查询可能使用多个 `SELECT` 子句，每个子句最多支持127个窗口。
>
> 窗口数量定义为：命名窗口数量 + 各个窗口函数 `OVER` 子句中隐式指定的窗口数量之和。  
>
> 如果查询使用了大量窗口，可能需要增加默认线程堆栈大小（`thread_stack` 系统变量）。