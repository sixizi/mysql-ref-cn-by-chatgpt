#### 7.6.7.2 本地克隆数据

clone 插件支持以下语法用于本地克隆数据，即将数据从本地 MySQL 的数据目录克隆到运行该 MySQL 服务器实例的同一台服务器或节点上的另一个目录：

```mysql
CLONE LOCAL DATA DIRECTORY [=] 'clone_dir';
```

要使用 CLONE 语法，必须已安装 clone 插件。安装说明请参见 [7.6.7.1节，安装 clone 插件](#7-6-7-1-installing-the-clone-plugin)。

执行 CLONE LOCAL DATA DIRECTORY 语句需要具有 BACKUP_ADMIN 权限：

```mysql
mysql> GRANT BACKUP_ADMIN ON *.* TO 'clone_user';
```

其中，`clone_user` 是执行克隆操作的 MySQL 用户。执行克隆操作的用户可以是任意在 *.* 上具有 `BACKUP_ADMIN` 权限的 MySQL 用户。

以下示例演示如何进行本地克隆：

```mysql
mysql> CLONE LOCAL DATA DIRECTORY = '/path/to/clone_dir';
```

其中 '/path/to/clone_dir' 是目标克隆目录的完整路径。必须使用**绝对路径**，且所指定的目录（即 `clone_dir`）**不能已经存在**，但路径本身必须是一个已存在的路径。MySQL 服务器必须拥有创建该目录所需的写权限。

> **注意**
>
> 本地克隆操作**不支持**克隆位于数据目录之外的用户创建的表或表空间。尝试克隆此类对象将导致如下错误：
>
> ERROR 1086 (HY000): File '/path/to/tablespace_name.ibd' already exists.
>
> 因为如果目标路径与源表空间路径相同，会产生冲突，因此被禁止。

除上述限制外，所有用户创建的 InnoDB 表和表空间、InnoDB 系统表空间、redo logs、undo tablespaces 都会被克隆到指定目录中。

克隆完成后，如果需要，可以使用克隆出来的数据目录启动 MySQL 服务器：

```mysql
$> mysqld_safe --datadir=clone_dir
```

其中 clone_dir 是克隆数据的目标目录。

关于如何监控克隆操作的状态与进度，请参见 [7.6.7.10节，监控克隆操作](#7-6-7-10-monitoring-cloning-operations)。